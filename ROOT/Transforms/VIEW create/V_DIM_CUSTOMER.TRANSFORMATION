{"job":{"components":{"12094":{"id":12094,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":169,"y":121,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[12103],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL 0"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT \n\t'MOVEX USA 12.6' AS SOURCE,\n\tOKCONO AS CUSTOMER_COMPANY,\n\tOKCUNO AS CUSTOMER_KEY,\n\tOKCUNM AS CUSTOMER_NAME,\t\n\tOKCSCD AS CUSTOMER_COUNTRY_KEY,\n\t'' AS CUSTOMER_CITY,\n\tOKACRF AS CUSTOMER_ACRF_CODE,\n\tCUSTOMER_BUSINESS_TEAM,\n\tOKCUCD AS CUSTOMER_CURRENCY_KEY,\n\tOKTEPY AS CUSTOMER_PAYMENT_TERM_CODE,\n\tCUSTOMER_PAYMENT_TERM_DESCRIPTION,\n\tOKCRL3 AS CUSTOMER_CREDIT_LIMIT,\n\tOKCFC9 AS CUSTOMER_CREDIT_CHECK,   \n\tOKPYCD AS CUSTOMER_DIRECT_WEDHELP, \n\tOKDIVI AS CUSTOMER_DIVISION, \n\tOKSTAT AS CUSTOMER_STATUS_CODE,\n\t\tCASE \tWHEN OKSTAT = '10'\n\t\t\t\tTHEN 'Preliminary'\n\t\t\t\tWHEN OKSTAT = '11'\n\t\t\t\tTHEN 'Temp cust no'\n\t\t\t\tWHEN OKSTAT = '12'\n\t\t\t\tTHEN 'Incorr values'\n\t\t\t\tWHEN OKSTAT = '20'\n\t\t\t\tTHEN 'Definite'\n\t\t\t\tWHEN OKSTAT = '90'\n\t\t\t\tTHEN 'Blocked/expired'\n\t\t\t\tELSE 'Unknown'\n\t\tEND AS CUSTOMER_STATUS_DESCRIPTION,\n\tOKCUCL AS CUSTOMER_GROUP,\n\tCUSTOMER_GROUP_DESCRIPTION,\n\tOKTEDL AS CUSTOMER_DELIVERY_TERMS,\n\tOKMODL AS CUSTOMER_DELIVERY_METHOD_CODE,\n\tCUSTOMER_DELIVERY_METHOD_DESCRIPTION,\n\tOKDISY AS CUSTOMER_DISCOUNT_MODEL, \n\tOKCFC1 AS CUSTOMER_DISCOUNT_GROUP, \n\tOKVTCD AS CUSTOMER_VAT_CODE, \n\tOKTXAP AS CUSTOMER_TAX_APPLICABLE,\n\tOKPLTB AS CUSTOMER_PRICE_LIST,  \n\tOKORTP AS CUSTOMER_ORDER_TYPE, \n\tOKWHLO AS CUSTOMER_WAREHOUSE,  \n\tOKTEPA AS CUSTOMER_VAS_CODE,     \n\tOKPRIO AS CUSTOMER_PRIORITY_CODE,  \n\tCUSTOMER_PRIORITY_DESCRIPTION,\n\tOKCCUS AS SALES_CHANNEL_DESCRIPTION,\n\tOKPONO AS CUSTOMER_POST_CODE, \n\tOKCFC3 AS CUSTOMER_BUSINESS_BU_CODE,\n\tCUSTOMER_BUSINESS_BU_DESCRIPTION,\n\tOKCFC6 AS OLD_CUSTOMER,  \n\tOKFACI AS CUSTOMER_FACILITY,\n\tCUSTOMER_EMAIL,\n\tOKPHNO AS CUSTOMER_PHONE,\n\t'' AS CUSTOMER_PLANNING_CODE,\n\t'' AS CUSTOMER_PLANNING_DESCRIPTION,\n\tOKSDST AS REGION,\n\tTRIM(OKSMCD) AS DEFAULT_SALES_PERSON,\n\tOKFRE2 AS CUSTOMER_CATEGORY_CODE,\n   CUSTOMER_CATEGORY_DESCRIPTION,\n\tOKECAR AS CUSTOMER_STATE,\n\tOKCUA1 AS CUSTOMER_ADDRESS1,\n\tOKCUA2 AS CUSTOMER_ADDRESS2,\n\tOKCUA3 AS CUSTOMER_ADDRESS3,\n\tOKPYNO AS PAYER,\n\t'' AS PAYER_NAME,\n\tCASE \tWHEN OKCFC0 IN (0,2)\n\t\t\t\tTHEN 1\n\t\t\t\tELSE 0\n\tEND AS CUSTOMER_INTERCOMPANY_IND,\n\tCASE \tWHEN OKCFC0 = 0\n\t\t\tTHEN 'Internal'\n\t\t\tELSE 'External'\n\tEND AS CUSTOMER_INTERCOMPANY_DESCRIPTION,\n\t'' AS CUSTOMER_TYPE,\n\t'' AS WHOLESALES_TYPE,\n\t'' AS MARKET_TYPE //,\n--\tDATE(TIMESTAMP_FORMAT(CHAR(OKRGDT),'YYYYMMDD')) AS ENTRY_DATE,\n--\tDATE(TIMESTAMP_FORMAT(CHAR(OKLMDT),'YYYYMMDD')) AS UPDATE_DATE\nFROM DWH_AREA.DRUS_OCUSMA\t\nleft outer join (\n    SELECT CTSTKY, CTTX40 as CUSTOMER_BUSINESS_TEAM FROM DWH_AREA.DRUS_CSYTAB_2\n WHERE CTDIVI = '' AND CTSTCO like '%BTCO%' \n    ) BTCO_TAB on BTCO_TAB.CTSTKY = DRUS_OCUSMA.OKACRF\nleft outer join (\n    SELECT CTSTKY, CTTX40 as CUSTOMER_PAYMENT_TERM_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2\n WHERE CTDIVI = '' AND CTSTCO = 'TEPY'\n    ) TEPY_TAB on TEPY_TAB.CTSTKY = DRUS_OCUSMA.OKTEPY  \n left outer join \n (SELECT CTSTKY, TRIM(CTTX15) as CUSTOMER_GROUP_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2 WHERE CTSTCO = 'CUCL' ) as CUCL_TAB \n on CUCL_TAB.CTSTKY= DRUS_OCUSMA.OKCUCL  \n left outer join\n ( SELECT  CTSTKY, TRIM(CTTX15) as CUSTOMER_DELIVERY_METHOD_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2 WHERE CTSTCO = 'MODL' ) as MODL_TAB \n on MODL_TAB.CTSTKY= DRUS_OCUSMA.OKMODL\nleft outer join\n(SELECT CTSTKY, TRIM(CTTX40) as CUSTOMER_PRIORITY_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2 WHERE CTSTCO = 'PRIP' ) as PRIP_TAB\non PRIP_TAB.CTSTKY = DRUS_OCUSMA.OKPRIO\nleft outer join \n(\n    SELECT CTSTKY, CTTX15 as CUSTOMER_BUSINESS_BU_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2 WHERE  CTSTCO = 'CFC3' \n) CFC3 on CFC3.CTSTKY= DRUS_OCUSMA.OKCFC3\nleft outer join\n(\nSELECT CBEMKY, MAX(CBEMAL) as CUSTOMER_EMAIL FROM DWH_AREA.DRUS_CEMAIL WHERE CBCONO = 400 AND CBEMTP = '01' \n    group by CBEMKY\n    \n) EMAIL on EMAIL.CBEMKY = DRUS_OCUSMA.OKCUNO\nleft outer join\n( SELECT CTSTKY, TRIM(CTTX15) as CUSTOMER_CATEGORY_DESCRIPTION FROM DWH_AREA.DRUS_CSYTAB_2 WHERE CTSTCO = 'FRE2' )\nFRE2 on FRE2.CTSTKY = DRUS_OCUSMA.OKFRE2\nWHERE OKCONO = 400"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"12101":{"id":12101,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":-319648201,"x":320,"y":130,"width":32,"height":32,"inputConnectorIDs":[12103],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create View 0"}}}},"visible":true},"2":{"slot":2,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"DWH"}}}},"visible":true},"3":{"slot":3,"name":"View Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"V_DIM_CUSTOMER"}}}},"visible":true},"5":{"slot":5,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Secure View","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"7":{"slot":7,"name":"View Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"12103":{"id":12103,"sourceID":12094,"targetID":12101}},"notes":{},"noteConnectors":{},"variables":{},"grids":{}},"info":{"name":"V_DIM_CUSTOMER","description":null,"type":"TRANSFORMATION","tag":"f50080be-5f05-48a2-8ee7-56f723985055"}}